(this.webpackJsonpmesssenger_app=this.webpackJsonpmesssenger_app||[]).push([[0],{11:function(e,t,n){},14:function(e,t,n){e.exports=n(21)},21:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),s=n(12),o=n.n(s),c=n(8),i=n.n(c),u=n(13),l=n(1),m=n(2),h=n(4),p=n(3),b=n(6),d=n(5),g=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(h.a)(this,Object(p.a)(t).call(this,e))).state={username:null},n.onChange=n.onChange.bind(Object(b.a)(n)),n.onSubmit=n.onSubmit.bind(Object(b.a)(n)),n}return Object(d.a)(t,e),Object(m.a)(t,[{key:"onChange",value:function(e){this.setState({username:e.target.value})}},{key:"onSubmit",value:function(e){e.preventDefault(),this.props.onSubmit(this.state.username)}},{key:"render",value:function(){return r.a.createElement("div",{className:"login"},r.a.createElement("div",{className:"login-triangle"}),r.a.createElement("h1",{className:"login-header"},"Welcome"),r.a.createElement("form",{className:"login-container",onSubmit:this.onSubmit},r.a.createElement("input",{type:"text",placeholder:"Username",onChange:this.onChange,required:"required"}),r.a.createElement("input",{type:"password",placeholder:"Password"}),r.a.createElement("input",{type:"submit"})))}}]),t}(r.a.Component),f=n(7),v=n(9),j=n.n(v),y=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(n=Object(h.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).updateScroll=function(){var e=document.querySelector(".message-list-container");!1===n.props.scrolled&&(e.scrollTop=e.scrollHeight)},n}return Object(d.a)(t,e),Object(m.a)(t,[{key:"componentDidUpdate",value:function(){setInterval(this.updateScroll,1e3)}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"message-list-container",onScroll:function(){return e.props.onScroll()}},this.props.messages.map((function(t,n){return r.a.createElement("div",{key:n},r.a.createElement("div",{className:"message-item"},r.a.createElement("span",null,e.props.currentUser.id===t.senderId?r.a.createElement("strong",null,r.a.createElement("font",{className:"special-text"},t.senderId)):r.a.createElement("strong",null,t.senderId)),r.a.createElement("br",null),r.a.createElement("p",{className:"message-list-text"},t.text)),r.a.createElement("br",null))})))}}]),t}(r.a.Component),O=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(h.a)(this,Object(p.a)(t).call(this,e))).state={text:""},n.onChange=n.onChange.bind(Object(b.a)(n)),n.onSubmit=n.onSubmit.bind(Object(b.a)(n)),n}return Object(d.a)(t,e),Object(m.a)(t,[{key:"onChange",value:function(e){this.setState({text:e.target.value}),this.props.onChange&&this.props.onChange()}},{key:"onSubmit",value:function(e){e.preventDefault(),this.props.onSubmit(this.state.text),this.setState({text:""})}},{key:"render",value:function(){return r.a.createElement("div",{className:"message-form-container"},r.a.createElement("div",{className:"message-form"},r.a.createElement("form",{onSubmit:this.onSubmit},r.a.createElement("input",{className:"message-form-input",type:"text",placeholder:"Message #"+this.state.currentRoom,onChange:this.onChange,value:this.state.text}))),this.state.text.length>2?r.a.createElement("div",{className:"message-form-return"},"Hit Enter to Send"):"")}}]),t}(r.a.Component),S=function(e){function t(){return Object(l.a)(this,t),Object(h.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return this.props.allUsersTyping.length>0?r.a.createElement("div",{className:"whos-typing-container"},"".concat(this.props.allUsersTyping.slice(0,2).join(" and ")," is typing...")):r.a.createElement("div",null)}}]),t}(r.a.Component),E=(n(11),function(e){function t(){return Object(l.a)(this,t),Object(h.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(m.a)(t,[{key:"renderUsers",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement("h3",{className:"whos-online-header"},"Current Room"),r.a.createElement("h5",{className:"whos-online-room"},"#",this.props.currentRoom.name),r.a.createElement("br",null),r.a.createElement("h3",{className:"whos-online-members"},1===this.props.users.length?this.props.users.length+" Member":this.props.users.length+" Members"),r.a.createElement("ul",{className:"whos-online-list"},this.props.users.map((function(t,n){return t.id===e.props.currentUser.id?r.a.createElement(U,{key:n,presenceState:"online"}," ",t.name," (You)"):r.a.createElement(U,{key:n,presenceState:t.presence.state},t.name)}))))}},{key:"render",value:function(){return this.props.users?this.renderUsers():r.a.createElement("p",null,"Loading Users...")}}]),t}(r.a.Component)),U=function(e){function t(){return Object(l.a)(this,t),Object(h.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement("li",{className:"OnlineUsersListElement"},r.a.createElement("div",{className:"OnlineUsersDivElement",style:{backgroundColor:"online"===this.props.presenceState?"#43ff4b":"#434956"}}),this.props.children)}}]),t}(r.a.Component),C=E,k=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(h.a)(this,Object(p.a)(t).call(this,e))).state={roomName:""},n.onChange=n.onChange.bind(Object(b.a)(n)),n.onSubmit=n.onSubmit.bind(Object(b.a)(n)),n}return Object(d.a)(t,e),Object(m.a)(t,[{key:"onChange",value:function(e){this.setState({roomName:e.target.value})}},{key:"onSubmit",value:function(e){e.preventDefault(),this.props.createRoom(this.state.roomName),this.setState({roomName:""})}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("form",{onSubmit:this.onSubmit},r.a.createElement("input",{value:this.state.roomName,onChange:this.onChange,type:"text",placeholder:"Enter New Room"}),r.a.createElement("input",{type:"submit"})))}}]),t}(r.a.Component),R=function(e){function t(){return Object(l.a)(this,t),Object(h.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"rooms-list"},r.a.createElement("ul",null,r.a.createElement("h3",null,"Your rooms:"),this.props.rooms.map((function(t){return r.a.createElement("li",{key:t.id,className:"room"},r.a.createElement("a",{onClick:function(){return e.props.subscribeToRoom(t.id)},href:"/#"},"#",t.name))}))))}}]),t}(r.a.Component),T=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(h.a)(this,Object(p.a)(t).call(this,e))).onScroll=function(){n.setState({scrolled:!0})},n.state={messages:[],joinableRooms:[],joinedRooms:[],currentUser:{},currentRoom:{},allUsersTyping:[],scrolled:!1,patientStatus:["Patient has Arrived","Patient is in Surgery","Patient has Left"]},n.sendMessage=n.sendMessage.bind(Object(b.a)(n)),n.userTypingEvent=n.userTypingEvent.bind(Object(b.a)(n)),n.createRoom=n.createRoom.bind(Object(b.a)(n)),n.subscribeToRoom=n.subscribeToRoom.bind(Object(b.a)(n)),n.buttonMessage=n.buttonMessage.bind(Object(b.a)(n)),n}return Object(d.a)(t,e),Object(m.a)(t,[{key:"userTypingEvent",value:function(){this.state.currentUser.isTypingIn({roomId:this.state.currentRoom.id}).catch((function(e){return console.error("error is:",e)}))}},{key:"sendMessage",value:function(e){this.state.currentUser.sendMessage({text:e,roomId:this.state.currentRoom.id}),this.setState({scrolled:!1})}},{key:"componentDidMount",value:function(){var e=this;new j.a.ChatManager({instanceLocator:"v1:us1:cda0f940-152b-46e7-b38b-e20c2eb435de",userId:this.props.currentUsername,tokenProvider:new j.a.TokenProvider({url:"http://localhost:8080/authenticate",method:"POST"})}).connect().then((function(t){return e.setState({currentUser:t}),e.getRooms(),t.subscribeToRoom({roomId:"c1d18c50-bb59-41aa-a7e9-706f7b158b2a",messageLimit:100,hooks:{onMessage:function(t){e.setState({messages:[].concat(Object(f.a)(e.state.messages),[t])})},onUserStartedTyping:function(t){e.setState({allUsersTyping:[].concat(Object(f.a)(e.state.allUsersTyping),[t.name])})},onUserStoppedTyping:function(t){e.setState({allUsersTyping:e.state.allUsersTyping.filter((function(e){return e!==t.name}))})},onPresenceChanged:function(){return e.forceUpdate()},onUserJoined:function(){return e.forceUpdate()}}})})).then((function(t){e.setState({currentRoom:t})})).catch((function(e){return console.error("error",e)}))}},{key:"getRooms",value:function(){var e=this;this.state.currentUser.getJoinableRooms().then((function(t){e.setState({joinableRooms:t,joinedRooms:e.state.currentUser.rooms})})).catch((function(e){return console.log("error on joining rooms: ",e)}))}},{key:"subscribeToRoom",value:function(e){var t=this;this.setState({messages:[]}),this.state.currentUser.subscribeToRoom({roomId:e,hooks:{onMessage:function(e){t.setState({messages:[].concat(Object(f.a)(t.state.messages),[e])})},onUserStartedTyping:function(e){t.setState({allUsersTyping:[].concat(Object(f.a)(t.state.allUsersTyping),[e.name])})},onUserStoppedTyping:function(e){t.setState({allUsersTyping:t.state.allUsersTyping.filter((function(t){return t!==e.name}))})},onPresenceChanged:function(){return t.forceUpdate()},onUserJoined:function(){return t.forceUpdate()}}}).then((function(e){t.setState({currentRoom:e})})).catch((function(e){return console.log("error on subscribing to rooms:",e)}))}},{key:"buttonMessage",value:function(){var e=this;this.state.currentUser.sendSimpleMessage({roomId:this.state.currentRoom.id,text:this.state.patientStatus[0]}).catch((function(t){console.log("error adding message to ".concat(e.state.currentRoom.name,": ").concat(t))}))}},{key:"createRoom",value:function(e){var t=this;null==e?console.log("error"):this.state.currentUser.createRoom({name:e}).then((function(e){t.subscribeToRoom(e.id),console.log("Created room: ".concat(e.name))})).catch((function(e){return console.error("error is:",e)}))}},{key:"render",value:function(){return r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"chatContainer"},r.a.createElement("div",{className:"whosOnlineListContainer"},r.a.createElement(C,{currentRoom:this.state.currentRoom,currentUser:this.state.currentUser,users:this.state.currentRoom.users}),r.a.createElement(R,{subscribeToRoom:this.subscribeToRoom,rooms:[].concat(Object(f.a)(this.state.joinableRooms),Object(f.a)(this.state.joinedRooms))})),r.a.createElement("div",{className:"chatListContainer"},r.a.createElement(y,{messages:this.state.messages,scrolled:this.state.scrolled,onScroll:this.onScroll,currentUser:this.state.currentUser}),r.a.createElement(S,{allUsersTyping:this.state.allUsersTyping}),r.a.createElement(O,{onSubmit:this.sendMessage,onChange:this.userTypingEvent,currentRoom:this.state.currentRoom})),r.a.createElement("form",null,r.a.createElement("input",{type:"button",placeholder:"Patient has arrived.",value:"Patient has arrived.",onClick:this.buttonMessage}),r.a.createElement("input",{type:"button",placeholder:"Patient is in surgery.",value:"Patient is in surgery."}),r.a.createElement("input",{type:"button",placeholder:"Patient has left.",value:"Patient has left."}))),r.a.createElement("div",null,r.a.createElement(k,{createRoom:this.createRoom})))}}]),t}(r.a.Component),N=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(h.a)(this,Object(p.a)(t).call(this,e))).onUserSubmitted=n.onUserSubmitted.bind(Object(b.a)(n)),n.state={currentScreen:"UsernameScreen",currentUsername:""},n}return Object(d.a)(t,e),Object(m.a)(t,[{key:"onUserSubmitted",value:function(e){var t=this;Object(u.a)(i.a.mark((function n(){return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,fetch("http://localhost:8080/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e})});case 3:204!==n.sent.status&&(t.setState({currentUsername:e,currentScreen:"ChatScreen"}),sessionStorage.setItem("username",e)),n.next=10;break;case 7:n.prev=7,n.t0=n.catch(0),console.error(n.t0);case 10:case"end":return n.stop()}}),n,null,[[0,7]])})))()}},{key:"render",value:function(){return"UsernameScreen"===this.state.currentScreen?r.a.createElement("div",null,r.a.createElement(g,{onSubmit:this.onUserSubmitted})):"ChatScreen"===this.state.currentScreen?r.a.createElement(T,{currentUsername:this.state.currentUsername,path:"/dashboard"}):void 0}}]),t}(a.Component);o.a.render(r.a.createElement(N,null),document.getElementById("root"))}},[[14,1,2]]]);
//# sourceMappingURL=main.d3aca92a.chunk.js.map